{"entries":[{"timestamp":1771761838618,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":159,"diffs":[[1,"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <block type=\"pxt-on-start\"></block>\n  <block type=\"device_forever\"></block>\n</xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":33,"diffs":[[1,"\n"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":119,"length1":86,"diffs":[[1,"        \"microphone\": \"*\"\n"]]},{"start1":209,"length1":41,"diffs":[[1,"        \"README.md\"\n"]]},{"start1":236,"length1":79,"diffs":[[1,"    \"additionalFilePaths\": []\n"]]}]},{"type":"added","filename":"test.ts","value":"// tests go here; this will not be compiled when this package is used as an extension.\n"},{"type":"added","filename":"custom.ts","value":"/**\n * Extension A4_Lampadaire - Blocs MakeCode micro:bit\n */\n//% block=\"A4_Lampadaire\" color=#4DA3FF icon=\"\\uf0eb\" weight=45\nnamespace A4_Lampadaire {\n\n    // --- Réglages matériels ---\n    const NB_LED = 10\n    const PIN_NEOPIXEL = DigitalPin.P1\n\n    // Ruban NeoPixel (initialisé à la première utilisation)\n    let ruban: neopixel.Strip = null\n\n    // Luminosité mémorisée en % (0..100). Défaut : 100%\n    let luminositePct = 100\n\n    function getRuban(): neopixel.Strip {\n        if (!ruban) {\n            ruban = neopixel.create(PIN_NEOPIXEL, NB_LED, NeoPixelMode.RGB)\n            ruban.clear()\n            ruban.show()\n            // Applique la luminosité mémorisée dès la création\n            ruban.setBrightness(Math.idiv(luminositePct * 255, 100))\n        }\n        return ruban\n    }\n\n    // --- Jour / Nuit ---\n    let seuilJourNuitPct = 50\n    let seuilJourNuitLL = 127\n\n    /**\n     * Seuil jour/nuit (0..100)\n     */\n    //% block=\"Seuil jour/nuit $seuil\"\n    //% seuil.min=0 seuil.max=100 seuil.defl=50\n    export function seuilJourNuit(seuil: number): void {\n        if (seuil < 0) seuil = 0\n        else if (seuil > 100) seuil = 100\n\n        seuilJourNuitPct = seuil\n        seuilJourNuitLL = Math.idiv(seuil * 255, 100)\n    }\n\n    /**\n     * Lire le niveau lumineux ambiant (0..100)\n     */\n    //% block=\"Lire lumière (0 à 100)\"\n    export function lireLumiere0a100(): number {\n        return Math.idiv(input.lightLevel() * 100, 255)\n    }\n\n    /**\n     * Jour\n     */\n    //% block=\"Jour\"\n    export function jour(): boolean {\n        return input.lightLevel() > seuilJourNuitLL\n    }\n\n    /**\n     * Nuit\n     */\n    //% block=\"Nuit\"\n    export function nuit(): boolean {\n        return input.lightLevel() <= seuilJourNuitLL\n    }\n\n    // --- Lampadaire (P0) ---\n    /**\n     * Allumer Lampadaire (P0=1) + affiche 1\n     */\n    //% block=\"Allumer Lampadaire\"\n    export function allumerLampadaire(): void {\n        pins.digitalWritePin(DigitalPin.P0, 1)\n        basic.showNumber(1)\n    }\n\n    /**\n     * Eteindre Lampadaire (P0=0) + affiche 0\n     */\n    //% block=\"Eteindre Lampadaire\"\n    export function eteindreLampadaire(): void {\n        pins.digitalWritePin(DigitalPin.P0, 0)\n        basic.showNumber(0)\n    }\n\n    // --- NeoPixel (P1) ---\n    export enum ModeEclairage {\n        //% block=\"Eteindre\"\n        Eteindre = 0,\n        //% block=\"Blanc\"\n        Blanc = 1,\n        //% block=\"Bleu\"\n        Bleu = 2,\n        //% block=\"Vert\"\n        Vert = 3,\n        //% block=\"Magenta\"\n        Magenta = 4\n    }\n\n    /**\n     * Luminosité ruban (0..100)\n     */\n    //% block=\"Luminosité ruban (0 à 100) $niveau\"\n    //% niveau.min=0 niveau.max=100 niveau.defl=100\n    export function luminositeRuban(niveau: number): void {\n        if (niveau < 0) niveau = 0\n        else if (niveau > 100) niveau = 100\n\n        luminositePct = niveau\n\n        // Si le ruban existe déjà, applique immédiatement\n        if (ruban) {\n            ruban.setBrightness(Math.idiv(luminositePct * 255, 100))\n            ruban.show()\n        }\n    }\n\n    /**\n     * Eclairage (liste déroulante)\n     */\n    //% block=\"Eclairage $mode\"\n    //% mode.defl=ModeEclairage.Eteindre\n    export function eclairage(mode: ModeEclairage): void {\n        const s = getRuban()\n\n        // Réapplique la luminosité mémorisée au cas où\n        s.setBrightness(Math.idiv(luminositePct * 255, 100))\n\n        switch (mode) {\n            case ModeEclairage.Eteindre:\n                s.clear()\n                s.show()\n                break\n\n            case ModeEclairage.Blanc:\n                s.showColor(NeoPixelColors.White)\n                break\n\n            case ModeEclairage.Bleu:\n                s.showColor(NeoPixelColors.Blue)\n                break\n\n            case ModeEclairage.Vert:\n                s.showColor(NeoPixelColors.Green)\n                break\n\n            case ModeEclairage.Magenta:\n                s.showColor(neopixel.rgb(255, 0, 255))\n                break\n        }\n    }\n}"}]}],"snapshots":[{"timestamp":1771761838617,"editorVersion":"8.0.18","text":{"main.blocks":"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <block type=\"pxt-on-start\"></block>\n  <block type=\"device_forever\"></block>\n</xml>","main.ts":"\n","README.md":"","pxt.json":"{\n    \"name\": \"A4_Lampadaire\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"radio\": \"*\",\n        \"microphone\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\"\n    ],\n    \"additionalFilePaths\": []\n}\n"}}],"shares":[],"lastSaveTime":1771761986696}